---
description: Update the changelog with recent changes from the main branch
globs:
alwaysApply: false
---

# Update Changelog

Use this skill when asked to update the changelog, add changelog entries, or when someone says "update changelog", "/update-changelog", or similar.

## What the Changelog Is

The changelog lives at `src/lib/changelog.ts` as a typed array (`CHANGELOG_ENTRIES`). The page at `src/app/changelog/page.tsx` renders it grouped by month. Entries are user-facing — they describe features and improvements, not individual file changes.

## How to Update

### 1. Find what changed since the last entry

Run this command to see squash-merged commits on `main` since the last changelog date:

```bash
git log origin/main --oneline --since="YYYY-MM-DD"
```

Replace `YYYY-MM-DD` with the date of the most recent entry in `CHANGELOG_ENTRIES` (look at the first entry's `date` field).

For full PR descriptions (which contain the real context), run:

```bash
git log origin/main --format="---COMMIT---%n%H%n%ad%n%s%n%b" --date=short --since="YYYY-MM-DD"
```

### 2. Write user-facing entries

For each meaningful PR/change, create a `ChangelogEntry` object:

```typescript
{
  date: '2026-03-15',           // commit date (YYYY-MM-DD)
  title: 'Dark mode support',   // short, user-facing title
  description: 'Added ...',     // 1-2 sentences explaining what changed and why it matters
  category: 'added',            // one of: added | improved | fixed | security | infrastructure
}
```

**Guidelines for writing entries:**

- **DO** describe what the user gets: "Added dark mode toggle in settings"
- **DON'T** describe file changes: "Updated globals.css with dark theme variables"
- **DO** group related commits into a single entry when they're part of the same feature
- **DON'T** create an entry for every single commit — merge related work
- **DO** mention breaking changes or important migration notes
- **DON'T** include purely internal refactors unless they affect performance or reliability
- **DO** keep descriptions to 1-2 sentences max
- **Category guide:**
  - `added` — new features or capabilities
  - `improved` — enhancements to existing features, dependency upgrades
  - `fixed` — bug fixes
  - `security` — security patches
  - `infrastructure` — CI/CD, tooling, build system changes

### 3. Add entries to the array

Prepend new entries to the **top** of the `CHANGELOG_ENTRIES` array in `src/lib/changelog.ts`. Keep the date-descending order (newest first). Add a comment separator for the new month if needed:

```typescript
export const CHANGELOG_ENTRIES: ChangelogEntry[] = [
  // ── March 2026 ──────────────────────────────────────────────
  {
    date: '2026-03-15',
    title: 'Dark mode support',
    description: 'Added a dark mode toggle ...',
    category: 'added',
  },

  // ── February 2026 (existing entries below) ─────────────────
  ...
];
```

### 4. Verify

After updating, run:

```bash
pnpm run lint
pnpm run type-check
```

Then start the dev server and visit `/changelog` to confirm the new entries render correctly.

## Example Workflow

```
User: "update the changelog"

1. Read the top entry in CHANGELOG_ENTRIES to find the latest date
2. Run: git fetch origin main && git log origin/main --format="---COMMIT---%n%H%n%ad%n%s%n%b" --date=short --since="<latest_date>"
3. Read the commit messages and PR descriptions
4. Write concise, user-facing entries for each meaningful change
5. Prepend them to CHANGELOG_ENTRIES
6. Run lint + type-check
7. Confirm the page renders at /changelog
```
